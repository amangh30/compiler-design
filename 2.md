## Handles vs Viable Prefixes

### Handle
A **substring** in a right-sentential form that:
- Matches RHS of some production
- Can be reduced to LHS
- Represents next step in **reverse rightmost derivation**

### Viable Prefix  
A **prefix** of a right-sentential form that:
- Does **not extend beyond** the handle
- Can appear on parser's stack during valid parse
- LR parser **never shifts** past a handle

---

## Key Difference
- **Handle**: What to **reduce** (complete RHS)
- **Viable Prefix**: What's on **stack** (prefix of potential handle)

---

## Parsing Example

Grammar:
```
1. E → E + T
2. E → T
3. T → T * F  
4. T → F
5. F → id
```

Input: `id + id * id`

| Step | Stack Contents | Input Remaining | Action | Viable Prefix | Handle |
|------|----------------|-----------------|--------|---------------|--------|
| 1 | `$` | `id + id * id$` | Shift | `$` | - |
| 2 | `$ id` | `+ id * id$` | **Reduce F→id** | `$ id` | `id` |
| 3 | `$ F` | `+ id * id$` | Reduce T→F | `$ F` | `F` |
| 4 | `$ T` | `+ id * id$` | Reduce E→T | `$ T` | `T` |
| 5 | `$ E` | `+ id * id$` | Shift | `$ E` | - |
| 6 | `$ E +` | `id * id$` | Shift | `$ E +` | - |
| 7 | `$ E + id` | `* id$` | **Reduce F→id** | `$ E + id` | `id` |
| 8 | `$ E + F` | `* id$` | Reduce T→F | `$ E + F` | `F` |
| 9 | `$ E + T` | `* id$` | Shift | `$ E + T` | - |
| 10 | `$ E + T *` | `id$` | Shift | `$ E + T *` | - |
| 11 | `$ E + T * id` | `$` | **Reduce F→id** | `$ E + T * id` | `id` |
| 12 | `$ E + T * F` | `$` | Reduce T→T*F | `$ E + T * F` | `T * F` |
| 13 | `$ E + T` | `$` | Reduce E→E+T | `$ E + T` | `E + T` |
| 14 | `$ E` | `$` | Accept | `$ E` | - |

---

## Critical Observations

1. **Viable Prefix** = Always what's on stack (never extends past handle)
2. **Handle** = Appears on stack top when reduce action occurs
3. **LR Parser**: Shifts until viable prefix **becomes** a handle, then reduces
4. **Never shifts past handle** - this is why viable prefixes are "safe"

The stack always contains a **viable prefix** - a string that could lead to successful parsing when combined with remaining input.
